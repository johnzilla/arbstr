# Requirements Archive: v1.3 Cost Querying API

**Archived:** 2026-02-16
**Status:** SHIPPED

For current requirements, see `.planning/REQUIREMENTS.md`.

---

# Requirements: arbstr v1.3

**Defined:** 2026-02-16
**Core Value:** Smart model selection that minimizes sats spent per request without sacrificing quality

## v1.3 Requirements

Requirements for v1.3 Cost Querying API. Each maps to roadmap phases.

### Stats

- [ ] **STAT-01**: User can query aggregate summary (total requests, total cost sats, total input/output tokens, avg latency, success rate, error count, streaming count) via GET endpoint
- [ ] **STAT-02**: User can query the same aggregate stats grouped by model name

### Filtering

- [ ] **FILT-01**: User can scope any stats query to an arbitrary time window using ISO 8601 start and end parameters
- [ ] **FILT-02**: User can use preset shortcuts (last_1h, last_24h, last_7d, last_30d) instead of explicit timestamps
- [ ] **FILT-03**: User can narrow stats to a specific model or provider via query parameters

### Logs

- [ ] **LOG-01**: User can browse individual request records with page-based pagination
- [ ] **LOG-02**: User can filter request logs by model, provider, success status, or streaming flag
- [ ] **LOG-03**: User can sort request logs by timestamp, cost, or latency in ascending or descending order

## Future Requirements

Deferred to future release. Tracked but not in current roadmap.

### Provider Analytics

- **PROV-01**: User can query aggregate stats grouped by provider name

### Advanced Analytics

- **ADV-01**: User can query time-series bucketed data (hourly/daily) for trend analysis
- **ADV-02**: User can view latency percentiles (p50/p95/p99) in aggregate responses
- **ADV-03**: User can see cost savings estimate compared to most expensive provider

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| GraphQL analytics API | Overkill for single-user local proxy; predictable query patterns fit REST |
| Real-time streaming analytics (WebSocket/SSE) | Marginal value for local tool; clients can poll |
| CSV/Prometheus/OpenTelemetry export | SQLite database is directly accessible; premature integration |
| Budget alerts and notifications | Budget enforcement belongs in policy engine, not query endpoints |
| Multi-tenancy in analytics | Single-user local proxy; no concept of teams/organizations |
| Custom date format support | ISO 8601 exclusively; matches existing timestamp storage |

## Traceability

Which phases cover which requirements. Updated during roadmap creation.

| Requirement | Phase | Status |
|-------------|-------|--------|
| STAT-01 | Phase 11 | Pending |
| STAT-02 | Phase 11 | Pending |
| FILT-01 | Phase 11 | Pending |
| FILT-02 | Phase 11 | Pending |
| FILT-03 | Phase 11 | Pending |
| LOG-01 | Phase 12 | Pending |
| LOG-02 | Phase 12 | Pending |
| LOG-03 | Phase 12 | Pending |

**Coverage:**
- v1.3 requirements: 8 total
- Mapped to phases: 8
- Unmapped: 0

---
*Requirements defined: 2026-02-16*
*Last updated: 2026-02-16 after roadmap creation*
